{
  "meta": {
    "id": "jostle",
    "name": "Jostle",
    "source": "http://www.marksteeregames.com/Jostle_Go_rules.pdf",
    "tags": [],
    "author": "Mark Steere",
    "year": 2010,
    "instructions": {
      "startTurn": "Select which unit to jostle!",
      "selectunit": ["concat",
        "The current position is worth ",
        ["minus",["sizeof","initialfriend"],["sizeof","initialenemy"]],
        ". Select a lower value neighbour to jostle to"
      ],
      "selectmovetarget": ["concat",
        "That position would be worth ",
        ["minus",["sizeof","newfriend"],["sum",1,["sizeof","newenemy"]]],
        ". Press \"jostle\" to move here"
      ]
    }
  },
  "graphics": {
    "icons": { "checkers": "pawns" }
  },
  "board": { "height": 10, "width": 10 },
  "setup": {
    "checkers": {
      "1":["c4","c6","c8","d3","d5","d7","e4","e8","f3","f7","g4","g6","g8","h3","h5","h7"],
      "2":["c3","c5","c7","d4","d6","d8","e3","e7","f4","f8","g3","g5","g7","h4","h6","h8"]
    }
  },
  "startTurn": {
    "link": "selectunit"
  },
  "marks": {
    "selectunit": {
      "from": "mycheckers",
      "runGenerator": "findinitial",
      "link": "selectmovetarget"
    },
    "selectmovetarget": {
      "from": "movetargets",
      "runGenerator": "findnew",
      "link": ["if",["morethan",
        ["minus",["sizeof","newfriend"],["sum",1,["sizeof","newenemy"]]],
        ["minus",["sizeof","initialfriend"],["sizeof","initialenemy"]]
      ],"jostle"]
    }
  },
  "commands": {
    "jostle": {
      "applyEffect": ["moveat","selectunit","selectmovetarget"],
      "link": "endturn"
    }
  },
  "generators": {
    "findinitial": {
      "type": "neighbour",
      "dirs": [1,3,5,7],
      "start": "selectunit",
      "draw": {
        "neighbours": {
          "tolayer": ["ifelse",
            ["noneat","units",["target"]],
            "movetargets",
            ["ifelse",
              ["anyat","oppunits",["target"]],
              "initialenemy",
              "initialfriend"
            ]
          ]
        }
      }
    },
    "findnew": {
      "type": "neighbour",
      "dirs": [1,3,5,7],
      "start": "selectmovetarget",
      "ifover": "units",
      "draw": {
        "neighbours": {
          "tolayer": ["ifelse",
            ["anyat","oppunits",["target"]],
            "newenemy",
            "newfriend"
          ]
        }
      }
    }
  }
}