{
  "meta": {
    "id": "atrium",
    "name": "Atrium",
    "source": "http://www.di.fc.ul.pt/~jpn/gv/atrium.htm",
    "tags": ["formation","nocapture"],
    "author": "Guy Jeandel",
    "year": 2004,
    "tagline": "Be the first to form a line with one of your three unit types",
    "instructions": {
      "startTurn": ["line","Select a","king","or","queen","to move"],
      "selectunit": ["line","Select an orthogonal empty neighbour to move the","selectunit",["unitnameat","selectunit"],"to"],
      "selectmovetarget": ["line",
        "Press","move","to walk the",
        "selectunit",
        ["unitnameat","selectunit"],
        "to",
        "selectmovetarget"
      ]
    }
  },
  "graphics": {"icons":{"kings":"king","queens":"queen"}},
  "board": {"height":5,"width":5},
  "setup": {
    "kings": {
      "1": ["a2","c5","e2"],
      "2": ["b1","b5","e3"]
    },
    "queens": {
      "1": ["a3","d5","d1"],
      "2": ["a4","c1","e4"]
    }
  },
  "endGame": {
    "madewinline": { "condition": ["notempty","winline"], "show": "winline" }
  },
  "startTurn": {
    "link": "selectunit"
  },
  "marks": {
    "selectunit": {
      "from": "myunits",
      "runGenerator": "findmovetargets",
      "link": "selectmovetarget"
    },
    "selectmovetarget": {
      "from": "movetargets",
      "link": "move"
    }
  },
  "commands": {
    "move": {
      "applyEffect": ["moveat","selectunit","selectmovetarget"],
      "runGenerator": "findwinlines",
      "link": "endturn"
    }
  },
  "generators": {
    "findmovetargets": {
      "type": "neighbour",
      "start": "selectunit",
      "dirs": [1,3,5,7],
      "unlessover": "units",
      "draw": {
        "neighbours": {
          "tolayer": "movetargets"
        }
      }
    },
    "findwinlines": {
      "type": "walker",
      "starts": "myunits",
      "startasstep": true,
      "dirs": [1,2,3,4,5,6,7,8],
      "steps": ["ifelse",["anyat","mykings",["start"]],"mykings","myqueens"],
      "draw": {
        "steps": {
          "condition": ["same",["walklength"],3],
          "tolayer": "winline"
        }
      }
    }
  }
}