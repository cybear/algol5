{
  "meta": {
    "id": "aries",
    "name": "Aries",
    "source": "http://www.di.fc.ul.pt/~jpn/gv/aries.htm",
    "tags":["push","infiltrate","eradicate","multiplegoals"],
    "instructions": {
      "startTurn": "Select which unit to move",
      "selectunit": "Select where to move to",
      "selectmovetarget": ["line",
        "Press","move","to move from",
        "selectunit",
        "to",
        "selectmovetarget",
        ["if",
          ["notempty","squished"],
          ["line","and squash the enemy at",["pos",["onlyin","squished"]]]
        ]
      ]
    }
  },
  "graphics": { "tiles": {"corner":"playercolour"}, "icons": {"soldiers":"rook"} },
  "board": {
    "height": 8, "width": 8,
    "terrain": { "corner": {"1":["a1"],"2":["h8"]} }
  },
  "setup": { "soldiers": { "1": [["rect","a1","d4"]], "2": [["rect","e5","h8"]] } },
  "startTurn": { "link": "selectunit" },
  "endGame": {
    "invade": {"condition":["overlaps","oppcorner","myunits"],"show":["intersect","oppcorner","myunits"]}
  },
  "marks": {
    "selectunit": {
      "from": "myunits",
      "runGenerator": "findmovetargets",
      "link": "selectmovetarget"
    },
    "selectmovetarget": {
      "from": "movetargets",
      "runGenerator": ["if",["anyat","oppunits","selectmovetarget"],"findpushresults"],
      "link": "move"
    }
  },
  "commands": {
    "move": {
      "applyEffects": [
        ["pushin","beingpushed",["read","movetargets","selectmovetarget","dir"],1],
        ["killin","squished"],
        ["moveat","selectunit","selectmovetarget"]
      ],
      "link": "endturn"
    }
  },
  "generators": {
    "findmovetargets": {
      "type": "walker",
      "start": "selectunit",
      "dirs": [1,3,5,7],
      "blocks": "units",
      "draw": {
        "steps": {
          "tolayer": "movetargets"
        },
        "block": {
          "ifover": "oppunits",
          "tolayer": "movetargets",
          "include": {"dir":["dir"]}
        }
      }
    },
    "findpushresults": {
      "type": "walker",
      "start": "selectmovetarget",
      "dir": ["reldir",1,["read","movetargets","selectmovetarget","dir"]],
      "steps": "oppunits",
      "blocks": "myunits",
      "startasstep": true,
      "testblocksbeforesteps": true,
      "draw": {
        "steps": {
          "tolayer": "beingpushed"
        },
        "last": {
          "condition": ["valinlist",["stopreason"],["hitblock","outofbounds"]],
          "tolayer": "squished"
        }
      }
    }
  }
}